# 163
邮件附件自动爬取  
工具：  
采用selenium模拟控制浏览器动作  
下载chromedriver.exe或者firefoxdriver.exe用于浏览器动作API接口的调用
功能：
自动登陆163邮箱进行附件下载，根据关键字删选需要的附件

在爬取的过程中，会遇到元素无法滚动到视野中，或者无法找到元素，经过测试有下面的经验。  
编码的问题，尤其适用link_by_text由于HTML如果被转成了utf-8中文会变成类似\xe8\xbf\x94\xe5\x9b\x9e这样的形式  
所以这时候text是无法找到要定位的元素的。所以采用CSS选择器或者，XPATH定位元素比较好。  

除此以外，当打开一个邮件下载完毕附件，退回至邮件列表选中第二个邮件进行附件下载时，上一个邮件的HTML其实依然存在于当前HTML中，只是变成了灰色，
不可见了，但是当回退至列表再次进入第一封邮件时，HTML代码就变成了可见，可以推测出163邮件使用了代码缓存，即对于已经获取的的HTML代码被缓存进当前的HTML中，使得再次进入已经进入过的邮件更加快。这个其实也是造成了元素无法定位的一个原因，因为根据find_element_by_name类似的API定位到了变成了灰色的元素，所以即使找到了该元素，使用click点击时会提示元素无法滚动到视野中，这是因为定位到的是上一封邮件的相同位置的元素。  
该问题的发现得益于使用beautifulsoup定位附件的链接地址时总是下载到同一个附件，这是因为服务器定义不同的附件根据mid来区别的，如果每次get方法给的相同的mid就会得到相同的附件，我查看了每次的请求都是第一封邮件的mid，这就意味着第一封mid存在于第二封邮件的HTML中，根据分析，凡是访问的过的邮件的html页面都缓存于当面的HTML中.

